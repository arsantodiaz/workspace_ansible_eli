

Add-LocalGroupMember -Group "Remote Management Users" -Member "endiaz"
Add-LocalGroupMember -Group "Administrators" -Member "endiaz"

New-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -Name LocalAccountTokenFilterPolicy -Value 1 -PropertyType DWord -Force

New-NetFirewallRule -Name "Allow_WinRM_HTTP" -DisplayName "Allow WinRM HTTP" -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 5985
Restart-Service WinRM


ansible -i inventory uat_windows -m win_ping

ansible-vault encrypt_string '2212ChillaBocil' --name 'ansible_password'
nano host_vars/UAT-WS06.yml


Add-LocalGroupMember -Group "Remote Management Users" -Member "elife\sys-it-dc"
Add-LocalGroupMember -Group "Administrators" -Member "elife\sys-it-dc"

Add-LocalGroupMember -Group "Remote Management Users" -Member "adminbas"
Add-LocalGroupMember -Group "Administrators" -Member "adminbas"


sys-it-dc
2212chillabocil





Solusi untuk ELI-DB21
Silakan Remote Desktop (RDP) ke server 192.168.10.53 (ELI-DB21), lalu buka PowerShell as Administrator, dan jalankan langkah ini:

1. Cek Status Izin Shell
Ketik perintah ini:

PowerShell

winrm get winrm/config/winrs
Cari baris: AllowRemoteShellAccess. Kalau isinya false, itulah biang keroknya.

2. Aktifkan Paksa (The Fix)
Ketik perintah ini untuk mengizinkan remote shell:

PowerShell

Set-Item WSMan:\localhost\Shell\AllowRemoteShellAccess -Value $true
Atau pakai perintah cmd style:

DOS

winrm set winrm/config/winrs @{AllowRemoteShellAccess="true"}



# 1. Masuk ke lokasi Registry Policy WinRM
$path = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service\WinRS"

# 2. Cek kalau path-nya belum ada, kita buat dulu
if (!(Test-Path $path)) { New-Item -Path $path -Force }

# 3. Paksa nilainya jadi 1 (True/Enabled)
Set-ItemProperty -Path $path -Name "AllowRemoteShellAccess" -Value 1 -Type DWord




3. Cek Memory (Penyebab Error 500)
Kadang error "Code 500" juga muncul karena jatah memori untuk remote user terlalu kecil. Sekalian naikkan biar aman:

PowerShell

Set-Item WSMan:\localhost\Shell\MaxMemoryPerShellMB -Value 2048
4. Restart Service WinRM
Supaya efeknya jalan:

PowerShell

Restart-Service WinRM
Setelah itu, coba ping lagi dari Ansible:

Bash

ansible ELI-DB21 -i inventory -m win_ping
Kalau sudah SUCCESS, baru kita urus temannya yang satu lagi (ELI-DB11) yang masalah password/credential.





# 1. Pastikan user ada & passwordnya SAMA PERSIS dengan di Inventory/Host_vars
# (Ganti password di bawah sesuai yang kamu pakai di Ansible)
net user endiaz 2212ChillaBocil /add /y

# 2. Masukkan ke grup Admin
net localgroup administrators endiaz /add